$(document).ready(function(){function r(){for(var e=1;17>e;e++)if(13>e&&0!==parseInt(Grid[e])){var n=e+4;if(t(n)){o(e,n,Grid[e]);var i=!0}else if(parseInt(Grid[e])===parseInt(Grid[n])){d(e,n,Grid[e]);var i=!0}}return i?(r(),void 0):!1}function e(){for(var r=1;17>r;r++)if(r>4&&0!==parseInt(Grid[r])){var n=r-4;if(t(n)){o(r,n,Grid[r]);var i=!0}else if(parseInt(Grid[r])===parseInt(Grid[n])){d(r,n,Grid[r]);var i=!0}}return i?(e(),void 0):!1}function n(){for(var r=1;17>r;r++)if(1===parseInt(r)||5===parseInt(r)||9===parseInt(r)||13===parseInt(r))console.log("Already to the left side");else if(0!==parseInt(Grid[r])){var e=r-1;if(t(e)){o(r,e,Grid[r]);var i=!0}else if(parseInt(Grid[r])===parseInt(Grid[e])){d(r,e,Grid[r]);var i=!0}}return i?(n(),void 0):!1}function i(){for(var r=1;17>r;r++)if(4===parseInt(r)||8===parseInt(r)||12===parseInt(r)||16===parseInt(r))console.log("Already to the right side");else if(0!==parseInt(Grid[r])){var e=r+1;if(t(e)){o(r,e,Grid[r]);var n=!0}else if(parseInt(Grid[r])===parseInt(Grid[e])){d(r,e,Grid[r]);var n=!0}}return n?(i(),void 0):!1}function a(){for(var r=!0,e=1;17>e;e++)0===Grid[e]&&(r=!1);return r}function t(r){var e=!1;return 17>r&&0===Grid[r]?!0:e}function o(r,e,n){Grid[r]=0,Grid[e]=n}function d(r,e,n){Grid[r]=parseInt(0),Grid[e]=parseInt(n)+parseInt(n),s(n),g()}function s(r){var e=10*r;Score+=e,$("#score").empty().append(Score),2048===parseInt(r)&&l(!0)}function p(){Moves+=1,$("#moves").empty().append(Moves)}function f(){G(),v(),c(),u(),I(),m(),y(2),$(".end-game").hide()}function l(r){Game=!1,r===!0?$(".end-game").empty().append("YOU WIN !!!").show():$(".end-game").empty().append("YOU LOOSE :'(").show()}function c(){TilesClass={2:"one",4:"two",8:"three",16:"four",32:"five",64:"six",128:"seven",256:"eight",512:"nine",1024:"ten",2048:"eleven"}}function G(){Grid={1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0}}function v(){Merging={1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0,16:!0}}function u(){Score=0,$("#score").empty().append(Score)}function I(){Moves=0,$("#moves").empty().append(Moves)}function m(){Game=!0}function y(r){for(var e=0;r>e;e++){var n=Math.floor(16*Math.random()+1),i=Math.floor(100*Math.random()+1);0!==Grid[n]?y(r):Grid[n]=E(i)}g()}function h(){var r=Math.floor(16*Math.random()+1),e=Math.floor(100*Math.random()+1);0!==Grid[r]?h():Grid[r]=E(e),g()}function E(r){if(90>r)var e=2;else var e=4;return e}function g(){Y();for(var r=1;17>r;r++)0!==Grid[r]&&$("#tile-"+r).addClass(TilesClass[Grid[r]]).empty().append(Grid[r])}function Y(){$("#grid-wrapper").empty().append('<ul class="small-block-grid-4">');for(var r=1;17>r;r++)$(".small-block-grid-4").append('<li><div class="tile" id="tile-'+r+'">&nbsp;</div></li>');$("#grid-wrapper").append("</ul>")}KEY_DOWN=40,KEY_UP=38,KEY_LEFT=37,KEY_RIGHT=39,f(),$("body").on("click","a.button",function(){"new-game"===$(this).attr("role")&&f()}),$(document).on("keyup",function(t){Game&&(t.keyCode===KEY_LEFT&&(n()?h():a()?l(!1):h()),t.keyCode===KEY_RIGHT&&(i()?h():a()?l(!1):h()),t.keyCode===KEY_UP&&(e()?h():a()?l(!1):h()),t.keyCode===KEY_DOWN&&(r()?h():a()?l(!1):h()),(t.keyCode===KEY_LEFT||t.keyCode===KEY_DOWN||t.keyCode===KEY_UP||t.keyCode===KEY_RIGHT)&&p())}),$("#grid-wrapper").swipe({swipe:function(t,o){Game&&("left"===o&&(n()?h():a()?l(!1):h()),"right"===o&&(i()?h():a()?l(!1):h()),"up"===o&&(e()?h():a()?l(!1):h()),"down"===o&&(r()?h():a()?l(!1):h()),("left"===o||"right"===o||"up"===o||"down"===o)&&p())}})});